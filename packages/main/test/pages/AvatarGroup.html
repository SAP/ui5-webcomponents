<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta charset="utf-8">

	<title>avatar-group</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta charset="utf-8">

	<script data-ui5-config type="application/json">
		{
			"language": "EN"
		}
	</script>

	<script src="../../webcomponentsjs/webcomponents-loader.js"></script>
	<script src="../../resources/bundle.esm.js" type="module"></script>
	<script nomodule src="../../resources/bundle.es5.js"></script>

    <style>
		code { color: blue; font-size: small; }
		
		#individual-pop .avatar-slot,
		#groupPop .avatar-slot {
			display: inline-block;
		}

		#group-pop .avatar-slot {
			padding: 3px;
		}

		#group-pop .title-slot,
		#individual-pop .title-slot {
			display: inline-block;
			vertical-align: middle;
		}

		#group-pop .placeholder {
			display: flex;
			flex-wrap: wrap;
		}

    </style>

</head>

<body>
	<ul>
	    <li><a href="?sap-ui-theme=sap_fiori_3">Fiori 3</a></li>
		<li><a href="?sap-ui-theme=sap_fiori_3_dark">Fiori 3 Dark</a></li>
		<li><a href="?sap-ui-theme=sap_fiori_3_hcb">Fiori 3 High Contrast Black</a></li>
		<li><a href="?sap-ui-theme=sap_fiori_3_hcw">Fiori 3 High Contrast White</a></li>
		<li><a href="?sap-ui-theme=sap_belize">Belize</a></li>
		<li><a href="?sap-ui-theme=sap_belize_hcb">Belize High Contrast Black</a></li>
		<li><a href="?sap-ui-theme=sap_belize_hcw">Belize High Contrast White</a></li>
	</ul>
    <br>
    <span>or in the browser console, for example:</span>
    <code>window['sap-ui-webcomponents-bundle'].configuration.setTheme("sap_belize_hcb")</code>

    <br><br>

    <a href="?sap-ui-language=en">English</a> |
    <a href="?sap-ui-language=de">German</a> |
    <a href="?sap-ui-language=es">Spanish</a> |
    <a href="?sap-ui-language=fr">French</a>

    <br><br>

	<h1>Test your web components here</h1>
	
	<ui5-slider id="slider" min="1" max="100" value="60" class="slider"></ui5-slider>

	<div id="avatar-group-wrapper">

		<ui5-popover header-text="My Heading" id="group-pop" style="width: 400px" placement-type="Bottom" aria-label="This popover is important">
			<div slot="header">
				<h5>Business card</h5>
			</div>
			
			<div class="placeholder" style="display: flex;"> 
				<!-- TODO -->
			</div>

			<div slot="footer">
				<p>this is footer</p>
			</div>
		</ui5-popover>

		<ui5-popover header-text="My Heading" id="individual-pop" style="width: 300px" placement-type="Bottom" aria-label="This popover is important" prevent-focus-restore>
			<div slot="header">
				<h5>Business card</h5>
			</div>
			
			<div class="avatar-slot">
				<ui5-avatar id="pop-avatar"></ui5-avatar>
			</div>
			<div class="title-slot">
				<ui5-title level="H5">John Doe</ui5-title>
				<ui5-title level="H5">Software Developer</ui5-title>
			</div>

			<div slot="footer">
				<p>this is footer</p>
			</div>
		</ui5-popover>
		<ui5-avatar-group type="Individual" avatar-size="XL" id="avatar-group-individual">
			<ui5-avatar interactive initials="LL" id="avatar-1"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
			<ui5-avatar interactive initials="LL"></ui5-avatar> 
		</ui5-avatar-group>
		<br>
		<ui5-avatar-group type="Group" avatar-size="M" id="avatar-group-group">
			<ui5-avatar initials="LL" image="./img/woman_avatar_5.png"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL" image="./img/Lamp_avatar_01.jpg"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL" image="./img/John_Miller.png"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL" image="./img/woman_avatar_5.png"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL" image="./img/Lamp_avatar_01.jpg"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
			<ui5-avatar initials="LL"></ui5-avatar>
		</ui5-avatar-group>
		<br>

		<div class="demo-section">
			<span>TargetRef Tag Name: </span>
			<input type="text" id="event-target" />
	
			<br>
			<br>
	
			<span>Event Overflow Button Clicked: </span>
			<input type="text" id="event-overflow-button-clicked" />
	
			<br>
			<br>
	
			<button id="reset-btn">Reset fields</button>
		</div>
	
	</div>

<script>
	// document.body.dir = "rtl";

	// ES5 
	var eventName = document.getElementById("event-name");
	var eventTargetRef = document.getElementById("event-target");
	var eventOverflowButtonClicked = document.getElementById("event-overflow-button-clicked");
	var avatarGroupIndividual = document.getElementById("avatar-group-individual");
	var avatarGroupGroup = document.getElementById("avatar-group-group");
	var groupPop = document.getElementById("group-pop")
	var individualPop = document.getElementById("individual-pop")
	var popAvatar = document.getElementById("pop-avatar")
	var resetBtn = document.getElementById("reset-btn")
	var slider = document.getElementById("slider");
	var avGrWrapper = document.getElementById("avatar-group-wrapper");

	slider.style.width = '100%';
	avGrWrapper.style.width = slider.getAttribute("value") + '%';

	function onButtonClicked(avatarGroup, event) {
		var hiddenItems = avatarGroup.type === "Group" ? avatarGroup.items : avatarGroup.hiddenItems;
		var items = avatarGroup.items.slice();
		var placeholder = groupPop.querySelector(".placeholder");
		var firstHiddenIndex = avatarGroup.items.length - hiddenItems.length;
		var color;

		var html = "";
		
		hiddenItems.forEach(function (avatar, index) {
			var color = avatarGroup.colorScheme[firstHiddenIndex + index]
			html += '<div class="avatar-slot" style="padding: 5px">' +
						'<ui5-avatar interactive icon="' + avatar.icon + '" image="' + avatar.image + '" initials="' + avatar.initials + '" background-color="' + color + '"></ui5-avatar>' +
					'</div>';
		});

		for (var index = 0; index < hiddenItems; index++) {
			var avatarRef = items[index];

			html +=  '<div class="avatar-slot">' +
						'<ui5-avatar interactive image="' + avatarRef.image + '" initials="' + avatarRef.initials + '" background-color="' + avatarRef._effectiveBackgroundColor + '"></ui5-avatar>' +
					'</div>';
		}
		placeholder.innerHTML = html;

		groupPop.close();
		groupPop.openBy(event.detail.targetRef);
	}

	function onAvatarClicked(avatarGroup, avatarRef) {
		popAvatar.image = avatarRef.image;
		popAvatar.initials = avatarRef.initials;
		popAvatar.backgroundColor = avatarGroup.colorScheme[avatarGroup.items.indexOf(avatarRef)];

		individualPop.close();
		individualPop.openBy(avatarRef);
	}


	avatarGroupIndividual.addEventListener("click", function (event) {
		eventTargetRef.value = event.detail.targetRef.tagName;
		eventOverflowButtonClicked.value = event.detail.overflowButtonClicked;
		
		if (event.detail.overflowButtonClicked) {
			onButtonClicked(avatarGroupIndividual, event);
		} else {
			onAvatarClicked(avatarGroupIndividual, event.detail.targetRef);
		}
	});

	avatarGroupGroup.addEventListener("click", function (event) { 
		eventTargetRef.value = event.detail.targetRef.tagName + '.' + event.detail.targetRef.className;
		eventOverflowButtonClicked.value = event.detail.overflowButtonClicked;

		onButtonClicked(avatarGroupGroup, event)
	});

	slider.addEventListener("input", function (event) {
		avGrWrapper.style.width = event.target.value + '%';
	});

	resetBtn.addEventListener("click", function (event) {
		eventName.value = "";
		eventTargetRef.value = "";
		eventOverflowButtonClicked.value = "";
	});
</script>

</body>


</html>
