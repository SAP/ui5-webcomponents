<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta charset="utf-8">

	<title>avatar-group</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta charset="utf-8">

	<script data-ui5-config type="application/json">
		{
			"language": "EN"
		}
	</script>

	<script src="../../webcomponentsjs/webcomponents-loader.js"></script>
	<script src="../../resources/bundle.esm.js" type="module"></script>
	<script nomodule src="../../resources/bundle.es5.js"></script>

	<style>
		code {
			color: blue;
			font-size: small;
		}

		.placeholder {
			display: flex;
			flex-wrap: wrap;
		}
	</style>

</head>

<body>
	<ui5-popover header-text="My people" id="popover" style="width: 400px" placement-type="Bottom">
		<div class="placeholder"></div>
	</ui5-popover>

	<ui5-slider id="slider" min="1" max="100" value="60" class="slider"></ui5-slider>

	<div id="avatar-group-wrapper">
		<ui5-avatar-group avatar-size="M" type="Individual" id="avatar-group-group"></ui5-avatar-group>
	</div>
	<script>
		const slider = document.getElementById("slider");
		const avGrWrapper = document.getElementById("avatar-group-wrapper");

		slider.style.width = '100%';
		avGrWrapper.style.width = slider.getAttribute("value") + '%';

		slider.addEventListener("input", function (event) {
			avGrWrapper.style.width = event.target.value + '%';
		});

		const group = document.getElementById("avatar-group-group");
		const popover = document.getElementById("popover");
		const popoverContent = popover.querySelector(".placeholder");
		let avatars = [];

		for (let i = 0; i < 500; i++) {
			avatars.push(createAvatar(i));
		}

		avatars.slice(0, 20).forEach(el => group.appendChild(el));

		group.overflowButtonText = "+99";

		onButtonClicked = (targetRef) => {
			let html = "";
			const firstHiddenIndex = group.items.length - group.hiddenItems.length;

			avatars.slice(firstHiddenIndex).forEach((avatar, index) => {
				html += `<ui5-avatar></ui5-avatar>`;
			});

			popover.headerText = `Popover items: ${avatars.length - firstHiddenIndex}`;
			popoverContent.innerHTML = html;
			popover.openBy(targetRef);
		}

		group.addEventListener("click", event => {
			if (event.detail.overflowButtonClicked) {
				onButtonClicked(event.detail.targetRef);
			}
		});

		createAvatar = () => {
			var avatar = document.createElement("ui5-avatar");
			avatar.setAttribute("initials", "MM")
			return avatar;
		};
	</script>

</body>


</html>