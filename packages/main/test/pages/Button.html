<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta charset="utf-8">
	<title>Button Click vs Long Press Menu Test</title>
	<script src="%VITE_BUNDLE_PATH%" type="module"></script>
	<style>
		body {
			font-family: Arial, sans-serif;
			padding: 40px;
			margin: 0;
			background-color: #f5f5f5;
		}
		
		.container {
			max-width: 600px;
			margin: 0 auto;
			background: white;
			padding: 30px;
			border-radius: 8px;
			box-shadow: 0 2px 10px rgba(0,0,0,0.1);
		}
		
		.instructions {
			background-color: #e3f2fd;
			padding: 20px;
			border-radius: 4px;
			margin-bottom: 30px;
			border-left: 4px solid #2196f3;
		}
		
		.test-button {
			/* Long press suppression */
			-webkit-touch-callout: none;
			touch-action: manipulation;
			-webkit-user-select: none;
			-moz-user-select: none;
			user-select: none;
		}
		
		.button-area {
			text-align: center;
			padding: 40px 20px;
		}
		
		.log {
			background-color: #1e1e1e;
			color: #00ff00;
			padding: 15px;
			border-radius: 4px;
			font-family: 'Courier New', monospace;
			height: 150px;
			overflow-y: scroll;
			margin-top: 20px;
			font-size: 12px;
		}
		
		h1 {
			text-align: center;
			color: #333;
			margin-bottom: 20px;
		}
	</style>
</head>
<body>
	<div class="container">
		<h1>Button Menu Test</h1>
		
		<div class="instructions">
			<h3>Instructions:</h3>
			<ul>
				<li><strong>Quick Click/Tap:</strong> Opens "Actions" menu</li>
				<li><strong>Long Press (300ms+):</strong> Opens "Context" menu</li>
				<li><strong>Desktop:</strong> Right-click also opens context menu</li>
			</ul>
		</div>
		
		<div class="button-area">
			<ui5-button 
				id="test-button" 
				class="test-button" 
				design="Emphasized" 
				icon="menu"
				accessibilityAttributes='{"hasPopup": "menu"}'>
				Click or Long Press Me
			</ui5-button>
		</div>
		
		<!-- Quick click menu -->
		<ui5-menu id="actions-menu" header-text="Actions">
			<ui5-menu-item icon="add" text="New Item"></ui5-menu-item>
			<ui5-menu-item icon="edit" text="Edit"></ui5-menu-item>
			<ui5-menu-item icon="refresh" text="Refresh"></ui5-menu-item>
		</ui5-menu>
		
		<!-- Long press context menu -->
		<ui5-menu id="context-menu" header-text="Context Options">
			<ui5-menu-item icon="copy" text="Copy"></ui5-menu-item>
			<ui5-menu-item icon="paste" text="Paste"></ui5-menu-item>
			<ui5-menu-separator></ui5-menu-separator>
			<ui5-menu-item icon="delete" text="Delete"></ui5-menu-item>
		</ui5-menu>
		
		<div class="log" id="log">
			<div>Event Log:</div>
		</div>
	</div>

	<script>
		const button = document.getElementById('test-button');
		const actionsMenu = document.getElementById('actions-menu');
		const contextMenu = document.getElementById('context-menu');
		const logEl = document.getElementById('log');
		
		let touchTimeout;
		let longPressTriggered = false;
		
		// Logging function
		function log(message) {
			const timestamp = new Date().toLocaleTimeString();
			logEl.innerHTML += `<div>[${timestamp}] ${message}</div>`;
			logEl.scrollTop = logEl.scrollHeight;
		}
		
		// Show menu function
		function showMenu(menuElement, menuName) {
			// Close any open menus first
			actionsMenu.open = false;
			contextMenu.open = false;
			
			// Open the specified menu
			menuElement.opener = button;
			menuElement.open = true;
			
			log(`${menuName} menu opened`);
		}
		
		// Touch/Mouse Events
		button.addEventListener('touchstart', (e) => {
			log('Touch start');
			longPressTriggered = false;
			
			touchTimeout = setTimeout(() => {
				longPressTriggered = true;
				log('Long press detected (300ms)');
				showMenu(contextMenu, 'Context');
			}, 300);
		});
		
		button.addEventListener('touchend', (e) => {
			clearTimeout(touchTimeout);
			log('Touch end');
			
			// Prevent click if long press was triggered
			if (longPressTriggered) {
				e.preventDefault();
				e.stopPropagation();
			}
		});
		
		button.addEventListener('touchcancel', (e) => {
			clearTimeout(touchTimeout);
			log('Touch canceled');
			longPressTriggered = false;
		});
		
		// Click event (for regular clicks and desktop)
		button.addEventListener('click', (e) => {
			if (!longPressTriggered) {
				log('Click detected');
				showMenu(actionsMenu, 'Actions');
			}
		});
		
		// Right-click for desktop context menu simulation
		button.addEventListener('contextmenu', (e) => {
			e.preventDefault(); // Suppress browser context menu
			log('Right-click detected (desktop context menu)');
			showMenu(contextMenu, 'Context');
		});
		
		// Menu event listeners
		actionsMenu.addEventListener('item-click', (e) => {
			log(`Actions menu item clicked: ${e.detail.text}`);
			actionsMenu.open = false;
		});
		
		contextMenu.addEventListener('item-click', (e) => {
			log(`Context menu item clicked: ${e.detail.text}`);
			contextMenu.open = false;
		});
		
		// Initialize
		document.addEventListener('DOMContentLoaded', () => {
			log('Button Menu Test initialized');
		});
	</script>
	
	<!-- Summary Section -->
	<div class="container" style="margin-top: 30px;">
		<div style="background-color: #fff3cd; padding: 20px; border-radius: 4px; border-left: 4px solid #ffc107;">
			<h2 style="margin-top: 0; color: #856404;">ðŸ“‹ Long Press Suppression Summary</h2>
			
			<h3>How to Suppress Long Press/Tap on UI5 Button:</h3>
			
			<h4>1. CSS Method (Primary)</h4>
			<pre style="background: #f8f9fa; padding: 15px; border-radius: 4px; overflow-x: auto;"><code>.ui5-button-suppress-longpress {
	/* Prevent iOS Safari context menu/touch callout */
	-webkit-touch-callout: none;
	
	/* Prevent Android long press & optimize touch response */
	touch-action: manipulation;
	
	/* Prevent text selection (additional protection) */
	-webkit-user-select: none;
	-moz-user-select: none;
	user-select: none;
}</code></pre>
			
			<h4>2. JavaScript Event Handling (Additional)</h4>
			<pre style="background: #f8f9fa; padding: 15px; border-radius: 4px; overflow-x: auto;"><code>// Suppress browser context menu
button.addEventListener('contextmenu', (e) => {
	e.preventDefault();
	return false;
});

// Handle custom long press detection
let touchTimeout;
button.addEventListener('touchstart', (e) => {
	touchTimeout = setTimeout(() => {
		// Custom long press logic here
	}, 300); // 300ms threshold
});

button.addEventListener('touchend', (e) => {
	clearTimeout(touchTimeout);
});</code></pre>
			
			<h4>3. Key Points</h4>
			<ul>
				<li><strong>CSS is the primary method</strong> - handles most browser behavior</li>
				<li><strong>JavaScript provides fine control</strong> - for custom interactions</li>
				<li><strong>Both methods combined</strong> ensure maximum compatibility</li>
				<li><strong>Works across platforms</strong> - iOS, Android, Desktop browsers</li>
			</ul>
			
			<h4>4. Browser Support</h4>
			<ul>
				<li><code>-webkit-touch-callout: none</code> â†’ iOS Safari, Chrome</li>
				<li><code>touch-action: manipulation</code> â†’ All modern browsers</li>
				<li><code>contextmenu</code> event prevention â†’ Universal</li>
			</ul>
		</div>
	</div>
</body>
</html>