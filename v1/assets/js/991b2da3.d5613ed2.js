"use strict";(self.webpackChunk_ui5_webcomponents_website=self.webpackChunk_ui5_webcomponents_website||[]).push([[534],{1289:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var o=n(1085),t=n(1184);const i={},r="CSP",c={id:"docs/advanced/CSP",title:"CSP",description:"To learn about Content Security Policy (CSP), click here.",source:"@site/docs/docs/2-advanced/08-CSP.md",sourceDirName:"docs/2-advanced",slug:"/docs/advanced/CSP",permalink:"/webcomponents/v1/docs/advanced/CSP",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Accessibility in UI5 Web Components",permalink:"/webcomponents/v1/docs/advanced/accessibility"},next:{title:"Scrollbars customization",permalink:"/webcomponents/v1/docs/advanced/scrollbars-customization"}},a={},l=[{value:"Background",id:"background",level:2},{value:"Turning on CSP Compliance for Firefox and Safari",id:"turning-on-csp-compliance-for-firefox-and-safari",level:2},{value:"Links Preloading",id:"links-preloading",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h1,{id:"csp",children:"CSP"}),"\n",(0,o.jsxs)(s.p,{children:["To learn about Content Security Policy (CSP), click ",(0,o.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",children:"here"}),"."]}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.em,{children:"Read this section if your site needs to be CSP-compliant. This article focuses on styles compliance."})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-js",children:'import { setUseLinks, setPackageCSSRoot } from "@ui5/webcomponents-base/dist/CSP.js";\n'})}),"\n",(0,o.jsxs)(s.p,{children:["These functions affect the way the UI5 Web Components framework manages CSS. This is important if you are aiming for CSP-compliance, since in order to be CSP-compliant, in the most general case, a site cannot use ",(0,o.jsx)(s.code,{children:"<style>"})," tags."]}),"\n",(0,o.jsx)(s.h2,{id:"background",children:"Background"}),"\n",(0,o.jsxs)(s.p,{children:["The UI5 Web Components framework can leverage CSS (for shadow roots and the ",(0,o.jsx)(s.code,{children:"<head>"}),") in 3 ways: with Constructable StyleSheets (",(0,o.jsx)(s.code,{children:"document.adoptedStyleSheets"}),")\nfor the browsers that support them, with ",(0,o.jsx)(s.code,{children:"<style>"})," tags, and with ",(0,o.jsx)(s.code,{children:"<link>"})," tags."]}),"\n",(0,o.jsxs)(s.table,{children:[(0,o.jsx)(s.thead,{children:(0,o.jsxs)(s.tr,{children:[(0,o.jsx)(s.th,{children:"Way to use CSS"}),(0,o.jsx)(s.th,{children:"Supported by"}),(0,o.jsx)(s.th,{children:"CSP Compliant"}),(0,o.jsx)(s.th,{children:"Extra setup required"})]})}),(0,o.jsxs)(s.tbody,{children:[(0,o.jsxs)(s.tr,{children:[(0,o.jsxs)(s.td,{children:["Constructable Stylesheets (",(0,o.jsx)(s.strong,{children:"default"})," for Chrome/Edge)"]}),(0,o.jsx)(s.td,{children:"Chrome / Edge"}),(0,o.jsx)(s.td,{children:"Yes"}),(0,o.jsx)(s.td,{children:"No"})]}),(0,o.jsxs)(s.tr,{children:[(0,o.jsxs)(s.td,{children:[(0,o.jsx)(s.code,{children:"<style>"})," (",(0,o.jsx)(s.strong,{children:"default"})," for Firefox/Safari)"]}),(0,o.jsx)(s.td,{children:"all"}),(0,o.jsx)(s.td,{children:"No"}),(0,o.jsx)(s.td,{children:"No"})]}),(0,o.jsxs)(s.tr,{children:[(0,o.jsxs)(s.td,{children:[(0,o.jsx)(s.code,{children:"<link>"})," (",(0,o.jsx)(s.em,{children:"optional for all browsers"}),")"]}),(0,o.jsx)(s.td,{children:"all"}),(0,o.jsx)(s.td,{children:"Yes"}),(0,o.jsx)(s.td,{children:"Yes (CSS files must be statically served)"})]})]})]}),"\n",(0,o.jsxs)(s.p,{children:["In summary, Constructable Stylesheets are both CSP-compliant and require no extra work on your part.\nTherefore, browsers that can use them (Chrome, Edge) are CSP-compliant out of the box. Firefox and Safari,\non the other hand, use ",(0,o.jsx)(s.code,{children:"<style>"})," tags by default, for both the shadow roots of web components, and in the HTML document's head,\nand are therefore ",(0,o.jsx)(s.strong,{children:"not"})," CSP-compliant by default."]}),"\n",(0,o.jsx)(s.h2,{id:"turning-on-csp-compliance-for-firefox-and-safari",children:"Turning on CSP Compliance for Firefox and Safari"}),"\n",(0,o.jsxs)(s.p,{children:["To make UI5 Web Components CSP-compliant also on Firefox and Safari, you need to copy the CSS resources for all relevant\nUI5 Web Components packages to where you can serve them, and use the ",(0,o.jsx)(s.code,{children:"setUseLinks"})," and ",(0,o.jsx)(s.code,{children:"setPackageCSSRoot"})," functions."]}),"\n",(0,o.jsx)(s.p,{children:"Example:"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:["First, copy the CSS files for all relevant packages to a directory that can be served, in this example, ",(0,o.jsx)(s.code,{children:"public/css/"}),":"]}),"\n"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-shell",children:"cp -r node_modules/@ui5/webcomponents-base/dist/css/ public/css/base/\ncp -r node_modules/@ui5/webcomponents-theming/dist/css/ public/css/theming/\ncp -r node_modules/@ui5/webcomponents/dist/css/ public/css/main/\ncp -r node_modules/@ui5/webcomponents-fiori/dist/css/ public/css/fiori/\n"})}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.em,{children:"Note: make these commands part of your build task, if your app needs to be CSP-compliant on all browsers."})}),"\n",(0,o.jsxs)(s.p,{children:["You will always need the CSS resources of the framework-level packages (",(0,o.jsx)(s.code,{children:"@ui5/webcomponents-base"})," and ",(0,o.jsx)(s.code,{children:"@ui5/webcomponents-theming"}),"),\nand additionally the ones of all components packages your app is going to use (such as ",(0,o.jsx)(s.code,{children:"@ui5/webcomponents"})," and ",(0,o.jsx)(s.code,{children:"@ui5/webcomponents-fiori"}),")."]}),"\n",(0,o.jsxs)(s.p,{children:["By convention, the CSS files are found in the ",(0,o.jsx)(s.code,{children:"dist/css/"})," directory for each package that ships CSS resources."]}),"\n",(0,o.jsxs)(s.ol,{start:"2",children:["\n",(0,o.jsx)(s.li,{children:"Call the 2 functions, described above, as follows:"}),"\n"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-js",children:'import { setPackageCSSRoot, setUseLinks } from "@ui5/webcomponents-base/dist/CSP.js";\n\nsetUseLinks(!document.adoptedStyleSheets); // or "true", to force all browsers to use links \nsetPackageCSSRoot("@ui5/webcomponents-base", "public/css/base/");\nsetPackageCSSRoot("@ui5/webcomponents-theming", "public/css/theming/");\nsetPackageCSSRoot("@ui5/webcomponents", "public/css/main/");\nsetPackageCSSRoot("@ui5/webcomponents-fiori", "public/css/fiori/");\n'})}),"\n",(0,o.jsxs)(s.p,{children:["Calling ",(0,o.jsx)(s.code,{children:"setUseLinks"})," with ",(0,o.jsx)(s.code,{children:"!document.adoptedStyleSheets"})," as its argument is an easy way to tell the\nframework to use ",(0,o.jsx)(s.code,{children:"<link>"})," tags only for the browsers that don't support Constructable Stylesheets.\nHowever, you can call ",(0,o.jsx)(s.code,{children:"setUseLinks(true)"})," to make all browsers consume CSS from ",(0,o.jsx)(s.code,{children:"<link>"}),"s, if you prefer so."]}),"\n",(0,o.jsxs)(s.p,{children:["Then, for each package, call ",(0,o.jsx)(s.code,{children:"setPackageCSSRoot"})," and pass the directory, from which the CSS files will be\nserved. You can pass relative paths to your HTML page, as in the example above, or fully qualified paths, for example:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-js",children:'setPackageCSSRoot("@ui5/webcomponents-base", "https://my.site/path/to/public/css/base/");\nsetPackageCSSRoot("@ui5/webcomponents-theming", "https://my.site/path/to/public/css/theming/");\nsetPackageCSSRoot("@ui5/webcomponents", "https://my.site/path/to/public/css/main/");\nsetPackageCSSRoot("@ui5/webcomponents-fiori", "https://my.site/path/to/public/css/fiori/");\n'})}),"\n",(0,o.jsxs)(s.p,{children:["It's simpler to just use relative paths, if your app is going to have one ",(0,o.jsx)(s.code,{children:"index.html"})," file, and you can\nconveniently point to a directory, relative to it. However, in case components will be used in different\npages across your site, or you are using URL re-writing, it would be safest to use fully qualified paths."]}),"\n",(0,o.jsx)(s.h2,{id:"links-preloading",children:"Links Preloading"}),"\n",(0,o.jsxs)(s.p,{children:["By default, when using ",(0,o.jsx)(s.code,{children:"<link>"}),"s, they are preloaded in the browser's ",(0,o.jsx)(s.code,{children:"<head>"})," (even the ones for shadow roots) in order to avoid\nflashing of un-styled content. These preloads have the form: ",(0,o.jsx)(s.code,{children:'<link rel="preload" as="style" ...>'}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["If, for any reason, you want to opt out of these preloads, you can do so by calling the ",(0,o.jsx)(s.code,{children:"setPreloadLinks"})," function:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-js",children:'import { setPreloadLinks } from "@ui5/webcomponents-base/dist/CSP.js";\nsetPreloadLinks(false);\n'})}),"\n",(0,o.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsxs)(s.p,{children:["By default, the UI5 Web Components framework manages CSS resources either with Constructable Stylesheets, or with ",(0,o.jsx)(s.code,{children:"<style>"})," tags.\nSince Constructable Stylesheets are CSP-compliant, UI5 Web Components is CSP-compliant on browsers\nthat support them (Chrome, Edge) out of the box. For the other browsers (Firefox, Safari), in order to\nachieve CSP-compliance, you must instruct the framework to use ",(0,o.jsx)(s.code,{children:"<link>"})," instead of ",(0,o.jsx)(s.code,{children:"<style>"})," tags, but\nthen you must also copy the CSS resources to a directory you can serve them from."]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},1184:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>c});var o=n(4041);const t={},i=o.createContext(t);function r(e){const s=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),o.createElement(i.Provider,{value:s},e.children)}}}]);